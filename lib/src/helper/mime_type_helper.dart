import 'dart:io';

import 'package:path/path.dart' as p;

import '../bean/resource.dart';

class MimeTypeHelper {
  static bool hasExtension(String? extension) {
    if (extension != null && extension.length > 0) {
      return _extensionToMimeTypeMap.containsKey(extension);
    }
    return false;
  }

  static bool hasMimeType(String? mimeType) {
    if (mimeType != null && mimeType.length > 0) {
      return _mimeTypeToExtensionMap.containsKey(mimeType);
    }
    return false;
  }

  static String? extensionToMimeType(String? extension) {
    if (extension != null && extension.length > 0) {
      return _extensionToMimeTypeMap[extension];
    }
    return null;
  }

  static String? mimeTypeToExtension(String? mimeType) {
    if (mimeType != null && mimeType.length > 0) {
      return _mimeTypeToExtensionMap[mimeType];
    }
    return null;
  }

  static String? getMimeTypeFromFile(File? file) {
    if (file != null) {
      var extension = p.extension(file.path).replaceFirst('.', '').toLowerCase();
      return extensionToMimeType(extension);
    }
    return null;
  }

  static String? getMimeTypeFromUri(Uri? uri) {
    if (uri != null && uri.pathSegments.isNotEmpty) {
      var extension = p.extension(uri.pathSegments.last).replaceFirst('.', '').toLowerCase();
      return extensionToMimeType(extension);
    }
    return null;
  }

  static ResourceType getResourceTypeFromMimeType(String? mimeType) {
    var result = ResourceType.unknown;
    if (mimeType != null) {
      if (mimeType.startsWith('text/')) {
        result = ResourceType.text;
      } else if (mimeType.startsWith('image/')) {
        result = ResourceType.image;
      } else if (mimeType.startsWith('video/')) {
        result = ResourceType.video;
      } else if (mimeType.startsWith('audio/')) {
        result = ResourceType.audio;
      } else if (mimeType.startsWith('application/')) {
        result = ResourceType.application;
      }
    }
    return result;
  }

  static ResourceType getResourceTypeFromFile(File? file) {
    return getResourceTypeFromMimeType(getMimeTypeFromFile(file));
  }

  static ResourceType getResourceTypeFromUri(Uri? uri) {
    return getResourceTypeFromMimeType(getMimeTypeFromUri(uri));
  }

  MimeTypeHelper._();
}

// Data from android.webkit.MimeTypeMap

const Map<String, String> _mimeTypeToExtensionMap = {
  "application/andrew-inset": "ez",
  "application/dsptype": "tsp",
  "application/futuresplash": "spl",
  "application/hta": "hta",
  "application/mac-binhex40": "hqx",
  "application/mac-compactpro": "cpt",
  "application/mathematica": "nb",
  "application/msaccess": "mdb",
  "application/oda": "oda",
  "application/ogg": "ogg",
  "application/pdf": "pdf",
  "application/pgp-keys": "key",
  "application/pgp-signature": "pgp",
  "application/pics-rules": "prf",
  "application/rar": "rar",
  "application/rdf+xml": "rdf",
  "application/rss+xml": "rss",
  "application/zip": "zip",
  "application/vnd.android.package-archive": "apk",
  "application/vnd.cinderella": "cdy",
  "application/vnd.ms-pki.stl": "stl",
  "application/vnd.oasis.opendocument.database": "odb",
  "application/vnd.oasis.opendocument.formula": "odf",
  "application/vnd.oasis.opendocument.graphics": "odg",
  "application/vnd.oasis.opendocument.graphics-template": "otg",
  "application/vnd.oasis.opendocument.image": "odi",
  "application/vnd.oasis.opendocument.spreadsheet": "ods",
  "application/vnd.oasis.opendocument.spreadsheet-template": "ots",
  "application/vnd.oasis.opendocument.text": "odt",
  "application/vnd.oasis.opendocument.text-master": "odm",
  "application/vnd.oasis.opendocument.text-template": "ott",
  "application/vnd.oasis.opendocument.text-web": "oth",
  "application/msword": "doc",
  "application/vnd.openxmlformats-officedocument.wordprocessingml.document": "docx",
  "application/vnd.openxmlformats-officedocument.wordprocessingml.template": "dotx",
  "application/vnd.ms-excel": "xls",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet": "xlsx",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.template": "xltx",
  "application/vnd.ms-powerpoint": "ppt",
  "application/vnd.openxmlformats-officedocument.presentationml.presentation": "pptx",
  "application/vnd.openxmlformats-officedocument.presentationml.template": "potx",
  "application/vnd.openxmlformats-officedocument.presentationml.slideshow": "ppsx",
  "application/vnd.rim.cod": "cod",
  "application/vnd.smaf": "mmf",
  "application/vnd.stardivision.calc": "sdc",
  "application/vnd.stardivision.draw": "sda",
  "application/vnd.stardivision.impress": "sdd",
  "application/vnd.stardivision.math": "smf",
  "application/vnd.stardivision.writer": "sdw",
  "application/vnd.stardivision.writer-global": "sgl",
  "application/vnd.sun.xml.calc": "sxc",
  "application/vnd.sun.xml.calc.template": "stc",
  "application/vnd.sun.xml.draw": "sxd",
  "application/vnd.sun.xml.draw.template": "std",
  "application/vnd.sun.xml.impress": "sxi",
  "application/vnd.sun.xml.impress.template": "sti",
  "application/vnd.sun.xml.math": "sxm",
  "application/vnd.sun.xml.writer": "sxw",
  "application/vnd.sun.xml.writer.global": "sxg",
  "application/vnd.sun.xml.writer.template": "stw",
  "application/vnd.visio": "vsd",
  "application/x-abiword": "abw",
  "application/x-apple-diskimage": "dmg",
  "application/x-bcpio": "bcpio",
  "application/x-bittorrent": "torrent",
  "application/x-cdf": "cdf",
  "application/x-cdlink": "vcd",
  "application/x-chess-pgn": "pgn",
  "application/x-cpio": "cpio",
  "application/x-debian-package": "deb",
  "application/x-director": "dcr",
  "application/x-dms": "dms",
  "application/x-doom": "wad",
  "application/x-dvi": "dvi",
  "application/x-flac": "flac",
  "application/x-font": "pfa",
  "application/x-freemind": "mm",
  "application/x-futuresplash": "spl",
  "application/x-gnumeric": "gnumeric",
  "application/x-go-sgf": "sgf",
  "application/x-graphing-calculator": "gcf",
  "application/x-gtar": "gtar",
  "application/x-hdf": "hdf",
  "application/x-ica": "ica",
  "application/x-internet-signup": "ins",
  "application/x-iphone": "iii",
  "application/x-iso9660-image": "iso",
  "application/x-jmol": "jmz",
  "application/x-kchart": "chrt",
  "application/x-killustrator": "kil",
  "application/x-koan": "skp",
  "application/x-kpresenter": "kpr",
  "application/x-kspread": "ksp",
  "application/x-kword": "kwd",
  "application/x-latex": "latex",
  "application/x-lha": "lha",
  "application/x-lzh": "lzh",
  "application/x-lzx": "lzx",
  "application/x-maker": "frm",
  "application/x-mif": "mif",
  "application/x-ms-wmd": "wmd",
  "application/x-ms-wmz": "wmz",
  "application/x-msi": "msi",
  "application/x-ns-proxy-autoconfig": "pac",
  "application/x-nwc": "nwc",
  "application/x-object": "o",
  "application/x-oz-application": "oza",
  "application/x-pkcs12": "p12",
  "application/x-pkcs7-certreqresp": "p7r",
  "application/x-pkcs7-crl": "crl",
  "application/x-quicktimeplayer": "qtl",
  "application/x-shar": "shar",
  "application/x-shockwave-flash": "swf",
  "application/x-stuffit": "sit",
  "application/x-sv4cpio": "sv4cpio",
  "application/x-sv4crc": "sv4crc",
  "application/x-tar": "tar",
  "application/x-texinfo": "texinfo",
  "application/x-troff": "t",
  "application/x-troff-man": "man",
  "application/x-ustar": "ustar",
  "application/x-wais-source": "src",
  "application/x-wingz": "wz",
  "application/x-webarchive": "webarchive",
  "application/x-x509-ca-cert": "crt",
  "application/x-x509-user-cert": "crt",
  "application/x-xcf": "xcf",
  "application/x-xfig": "fig",
  "application/xhtml+xml": "xhtml",
  "audio/3gpp": "3gpp",
  "audio/basic": "snd",
  "audio/midi": "mid",
  "audio/mpeg": "mpga",
  "audio/mpegurl": "m3u",
  "audio/prs.sid": "sid",
  "audio/x-aiff": "aif",
  "audio/x-gsm": "gsm",
  "audio/x-mpegurl": "m3u",
  "audio/x-ms-wma": "wma",
  "audio/x-ms-wax": "wax",
  "audio/x-pn-realaudio": "ra",
  "audio/x-realaudio": "ra",
  "audio/x-scpls": "pls",
  "audio/x-sd2": "sd2",
  "audio/x-wav": "wav",
  "image/bmp": "bmp",
  "image/gif": "gif",
  "image/ico": "cur",
  "image/ief": "ief",
  "image/jpeg": "jpeg",
  "image/pcx": "pcx",
  "image/png": "png",
  "image/svg+xml": "svg",
  "image/tiff": "tiff",
  "image/vnd.djvu": "djvu",
  "image/vnd.wap.wbmp": "wbmp",
  "image/x-cmu-raster": "ras",
  "image/x-coreldraw": "cdr",
  "image/x-coreldrawpattern": "pat",
  "image/x-coreldrawtemplate": "cdt",
  "image/x-corelphotopaint": "cpt",
  "image/x-icon": "ico",
  "image/x-jg": "art",
  "image/x-jng": "jng",
  "image/x-ms-bmp": "bmp",
  "image/x-photoshop": "psd",
  "image/x-portable-anymap": "pnm",
  "image/x-portable-bitmap": "pbm",
  "image/x-portable-graymap": "pgm",
  "image/x-portable-pixmap": "ppm",
  "image/x-rgb": "rgb",
  "image/x-xbitmap": "xbm",
  "image/x-xpixmap": "xpm",
  "image/x-xwindowdump": "xwd",
  "model/iges": "igs",
  "model/mesh": "msh",
  "text/calendar": "ics",
  "text/comma-separated-values": "csv",
  "text/css": "css",
  "text/html": "htm",
  "text/h323": "323",
  "text/iuls": "uls",
  "text/mathml": "mml",
  "text/plain": "txt",
  "text/richtext": "rtx",
  "text/rtf": "rtf",
  "text/texmacs": "ts",
  "text/text": "phps",
  "text/tab-separated-values": "tsv",
  "text/xml": "xml",
  "text/x-bibtex": "bib",
  "text/x-boo": "boo",
  "text/x-c++hdr": "h++",
  "text/x-c++src": "c++",
  "text/x-chdr": "h",
  "text/x-component": "htc",
  "text/x-csh": "csh",
  "text/x-csrc": "c",
  "text/x-dsrc": "d",
  "text/x-haskell": "hs",
  "text/x-java": "java",
  "text/x-literate-haskell": "lhs",
  "text/x-moc": "moc",
  "text/x-pascal": "p",
  "text/x-pcs-gcd": "gcd",
  "text/x-setext": "etx",
  "text/x-tcl": "tcl",
  "text/x-tex": "tex",
  "text/x-vcalendar": "vcs",
  "text/x-vcard": "vcf",
  "video/3gpp": "3gpp",
  "video/dl": "dl",
  "video/dv": "dif",
  "video/fli": "fli",
  "video/m4v": "m4v",
  "video/mpeg": "mpeg",
  "video/mp4": "mp4",
  "video/quicktime": "qt",
  "video/vnd.mpegurl": "mxu",
  "video/x-la-asf": "lsf",
  "video/x-mng": "mng",
  "video/x-ms-asf": "asf",
  "video/x-ms-wm": "wm",
  "video/x-ms-wmv": "wmv",
  "video/x-ms-wmx": "wmx",
  "video/x-ms-wvx": "wvx",
  "video/x-msvideo": "avi",
  "video/x-sgi-movie": "movie",
  "x-conference/x-cooltalk": "ice",
  "x-epoc/x-sisx-app": "sisx"
};

const Map<String, String> _extensionToMimeTypeMap = {
  "ez": "application/andrew-inset",
  "tsp": "application/dsptype",
  "spl": "application/x-futuresplash",
  "hta": "application/hta",
  "hqx": "application/mac-binhex40",
  "cpt": "image/x-corelphotopaint",
  "nb": "application/mathematica",
  "mdb": "application/msaccess",
  "oda": "application/oda",
  "ogg": "application/ogg",
  "pdf": "application/pdf",
  "key": "application/pgp-keys",
  "pgp": "application/pgp-signature",
  "prf": "application/pics-rules",
  "rar": "application/rar",
  "rdf": "application/rdf+xml",
  "rss": "application/rss+xml",
  "zip": "application/zip",
  "apk": "application/vnd.android.package-archive",
  "cdy": "application/vnd.cinderella",
  "stl": "application/vnd.ms-pki.stl",
  "odb": "application/vnd.oasis.opendocument.database",
  "odf": "application/vnd.oasis.opendocument.formula",
  "odg": "application/vnd.oasis.opendocument.graphics",
  "otg": "application/vnd.oasis.opendocument.graphics-template",
  "odi": "application/vnd.oasis.opendocument.image",
  "ods": "application/vnd.oasis.opendocument.spreadsheet",
  "ots": "application/vnd.oasis.opendocument.spreadsheet-template",
  "odt": "application/vnd.oasis.opendocument.text",
  "odm": "application/vnd.oasis.opendocument.text-master",
  "ott": "application/vnd.oasis.opendocument.text-template",
  "oth": "application/vnd.oasis.opendocument.text-web",
  "doc": "application/msword",
  "dot": "application/msword",
  "docx": "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
  "dotx": "application/vnd.openxmlformats-officedocument.wordprocessingml.template",
  "xls": "application/vnd.ms-excel",
  "xlt": "application/vnd.ms-excel",
  "xlsx": "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
  "xltx": "application/vnd.openxmlformats-officedocument.spreadsheetml.template",
  "ppt": "application/vnd.ms-powerpoint",
  "pot": "application/vnd.ms-powerpoint",
  "pps": "application/vnd.ms-powerpoint",
  "pptx": "application/vnd.openxmlformats-officedocument.presentationml.presentation",
  "potx": "application/vnd.openxmlformats-officedocument.presentationml.template",
  "ppsx": "application/vnd.openxmlformats-officedocument.presentationml.slideshow",
  "cod": "application/vnd.rim.cod",
  "mmf": "application/vnd.smaf",
  "sdc": "application/vnd.stardivision.calc",
  "sda": "application/vnd.stardivision.draw",
  "sdd": "application/vnd.stardivision.impress",
  "sdp": "application/vnd.stardivision.impress",
  "smf": "application/vnd.stardivision.math",
  "sdw": "application/vnd.stardivision.writer",
  "vor": "application/vnd.stardivision.writer",
  "sgl": "application/vnd.stardivision.writer-global",
  "sxc": "application/vnd.sun.xml.calc",
  "stc": "application/vnd.sun.xml.calc.template",
  "sxd": "application/vnd.sun.xml.draw",
  "std": "application/vnd.sun.xml.draw.template",
  "sxi": "application/vnd.sun.xml.impress",
  "sti": "application/vnd.sun.xml.impress.template",
  "sxm": "application/vnd.sun.xml.math",
  "sxw": "application/vnd.sun.xml.writer",
  "sxg": "application/vnd.sun.xml.writer.global",
  "stw": "application/vnd.sun.xml.writer.template",
  "vsd": "application/vnd.visio",
  "abw": "application/x-abiword",
  "dmg": "application/x-apple-diskimage",
  "bcpio": "application/x-bcpio",
  "torrent": "application/x-bittorrent",
  "cdf": "application/x-cdf",
  "vcd": "application/x-cdlink",
  "pgn": "application/x-chess-pgn",
  "cpio": "application/x-cpio",
  "deb": "application/x-debian-package",
  "udeb": "application/x-debian-package",
  "dcr": "application/x-director",
  "dir": "application/x-director",
  "dxr": "application/x-director",
  "dms": "application/x-dms",
  "wad": "application/x-doom",
  "dvi": "application/x-dvi",
  "flac": "application/x-flac",
  "pfa": "application/x-font",
  "pfb": "application/x-font",
  "gsf": "application/x-font",
  "pcf": "application/x-font",
  "pcf.Z": "application/x-font",
  "mm": "application/x-freemind",
  "gnumeric": "application/x-gnumeric",
  "sgf": "application/x-go-sgf",
  "gcf": "application/x-graphing-calculator",
  "gtar": "application/x-gtar",
  "tgz": "application/x-gtar",
  "taz": "application/x-gtar",
  "hdf": "application/x-hdf",
  "ica": "application/x-ica",
  "ins": "application/x-internet-signup",
  "isp": "application/x-internet-signup",
  "iii": "application/x-iphone",
  "iso": "application/x-iso9660-image",
  "jmz": "application/x-jmol",
  "chrt": "application/x-kchart",
  "kil": "application/x-killustrator",
  "skp": "application/x-koan",
  "skd": "application/x-koan",
  "skt": "application/x-koan",
  "skm": "application/x-koan",
  "kpr": "application/x-kpresenter",
  "kpt": "application/x-kpresenter",
  "ksp": "application/x-kspread",
  "kwd": "application/x-kword",
  "kwt": "application/x-kword",
  "latex": "application/x-latex",
  "lha": "application/x-lha",
  "lzh": "application/x-lzh",
  "lzx": "application/x-lzx",
  "frm": "application/x-maker",
  "maker": "application/x-maker",
  "frame": "application/x-maker",
  "fb": "application/x-maker",
  "book": "application/x-maker",
  "fbdoc": "application/x-maker",
  "mif": "application/x-mif",
  "wmd": "application/x-ms-wmd",
  "wmz": "application/x-ms-wmz",
  "msi": "application/x-msi",
  "pac": "application/x-ns-proxy-autoconfig",
  "nwc": "application/x-nwc",
  "o": "application/x-object",
  "oza": "application/x-oz-application",
  "p12": "application/x-pkcs12",
  "p7r": "application/x-pkcs7-certreqresp",
  "crl": "application/x-pkcs7-crl",
  "qtl": "application/x-quicktimeplayer",
  "shar": "application/x-shar",
  "swf": "application/x-shockwave-flash",
  "sit": "application/x-stuffit",
  "sv4cpio": "application/x-sv4cpio",
  "sv4crc": "application/x-sv4crc",
  "tar": "application/x-tar",
  "texinfo": "application/x-texinfo",
  "texi": "application/x-texinfo",
  "t": "application/x-troff",
  "roff": "application/x-troff",
  "man": "application/x-troff-man",
  "ustar": "application/x-ustar",
  "src": "application/x-wais-source",
  "wz": "application/x-wingz",
  "webarchive": "application/x-webarchive",
  "crt": "application/x-x509-user-cert",
  "xcf": "application/x-xcf",
  "fig": "application/x-xfig",
  "xhtml": "application/xhtml+xml",
  "3gpp": "video/3gpp",
  "snd": "audio/basic",
  "mid": "audio/midi",
  "midi": "audio/midi",
  "kar": "audio/midi",
  "mpga": "audio/mpeg",
  "mpega": "audio/mpeg",
  "mp2": "audio/mpeg",
  "mp3": "audio/mpeg",
  "m4a": "audio/mpeg",
  "m3u": "audio/x-mpegurl",
  "sid": "audio/prs.sid",
  "aif": "audio/x-aiff",
  "aiff": "audio/x-aiff",
  "aifc": "audio/x-aiff",
  "gsm": "audio/x-gsm",
  "wma": "audio/x-ms-wma",
  "wax": "audio/x-ms-wax",
  "ra": "audio/x-realaudio",
  "rm": "audio/x-pn-realaudio",
  "ram": "audio/x-pn-realaudio",
  "pls": "audio/x-scpls",
  "sd2": "audio/x-sd2",
  "wav": "audio/x-wav",
  "bmp": "image/x-ms-bmp",
  "gif": "image/gif",
  "cur": "image/ico",
  "ico": "image/x-icon",
  "ief": "image/ief",
  "jpeg": "image/jpeg",
  "jpg": "image/jpeg",
  "jpe": "image/jpeg",
  "pcx": "image/pcx",
  "png": "image/png",
  "svg": "image/svg+xml",
  "svgz": "image/svg+xml",
  "tiff": "image/tiff",
  "tif": "image/tiff",
  "djvu": "image/vnd.djvu",
  "djv": "image/vnd.djvu",
  "wbmp": "image/vnd.wap.wbmp",
  "ras": "image/x-cmu-raster",
  "cdr": "image/x-coreldraw",
  "pat": "image/x-coreldrawpattern",
  "cdt": "image/x-coreldrawtemplate",
  "art": "image/x-jg",
  "jng": "image/x-jng",
  "psd": "image/x-photoshop",
  "pnm": "image/x-portable-anymap",
  "pbm": "image/x-portable-bitmap",
  "pgm": "image/x-portable-graymap",
  "ppm": "image/x-portable-pixmap",
  "rgb": "image/x-rgb",
  "xbm": "image/x-xbitmap",
  "xpm": "image/x-xpixmap",
  "xwd": "image/x-xwindowdump",
  "igs": "model/iges",
  "iges": "model/iges",
  "msh": "model/mesh",
  "mesh": "model/mesh",
  "silo": "model/mesh",
  "ics": "text/calendar",
  "icz": "text/calendar",
  "csv": "text/comma-separated-values",
  "css": "text/css",
  "htm": "text/html",
  "html": "text/html",
  "323": "text/h323",
  "uls": "text/iuls",
  "mml": "text/mathml",
  "txt": "text/plain",
  "asc": "text/plain",
  "text": "text/plain",
  "diff": "text/plain",
  "po": "text/plain",
  "rtx": "text/richtext",
  "rtf": "text/rtf",
  "ts": "text/texmacs",
  "phps": "text/text",
  "tsv": "text/tab-separated-values",
  "xml": "text/xml",
  "bib": "text/x-bibtex",
  "boo": "text/x-boo",
  "h++": "text/x-c++hdr",
  "hpp": "text/x-c++hdr",
  "hxx": "text/x-c++hdr",
  "hh": "text/x-c++hdr",
  "c++": "text/x-c++src",
  "cpp": "text/x-c++src",
  "cxx": "text/x-c++src",
  "h": "text/x-chdr",
  "htc": "text/x-component",
  "csh": "text/x-csh",
  "c": "text/x-csrc",
  "d": "text/x-dsrc",
  "hs": "text/x-haskell",
  "java": "text/x-java",
  "lhs": "text/x-literate-haskell",
  "moc": "text/x-moc",
  "p": "text/x-pascal",
  "pas": "text/x-pascal",
  "gcd": "text/x-pcs-gcd",
  "etx": "text/x-setext",
  "tcl": "text/x-tcl",
  "tex": "text/x-tex",
  "ltx": "text/x-tex",
  "sty": "text/x-tex",
  "cls": "text/x-tex",
  "vcs": "text/x-vcalendar",
  "vcf": "text/x-vcard",
  "3gp": "video/3gpp",
  "3g2": "video/3gpp",
  "dl": "video/dl",
  "dif": "video/dv",
  "dv": "video/dv",
  "fli": "video/fli",
  "m4v": "video/m4v",
  "mpeg": "video/mpeg",
  "mpg": "video/mpeg",
  "mpe": "video/mpeg",
  "mp4": "video/mp4",
  "vob": "video/mpeg",
  "qt": "video/quicktime",
  "mov": "video/quicktime",
  "mxu": "video/vnd.mpegurl",
  "lsf": "video/x-la-asf",
  "lsx": "video/x-la-asf",
  "mng": "video/x-mng",
  "asf": "video/x-ms-asf",
  "asx": "video/x-ms-asf",
  "wm": "video/x-ms-wm",
  "wmv": "video/x-ms-wmv",
  "wmx": "video/x-ms-wmx",
  "wvx": "video/x-ms-wvx",
  "avi": "video/x-msvideo",
  "movie": "video/x-sgi-movie",
  "ice": "x-conference/x-cooltalk",
  "sisx": "x-epoc/x-sisx-app"
};
